<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="SikuliX Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="SikuliX Blog Atom Feed"><title data-react-helmet="true">Running Scripts | SikuliX</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Running Scripts | SikuliX"><meta data-react-helmet="true" name="description" content="Where and how can a SikuliX script be stored"><meta data-react-helmet="true" property="og:description" content="Where and how can a SikuliX script be stored"><meta data-react-helmet="true" property="og:url" content="https://sikulix.github.io/docs/scripts/running-scripts"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://sikulix.github.io/docs/scripts/running-scripts"><link rel="stylesheet" href="/styles.6ded2785.css">
<link rel="preload" href="/styles.6dc404e3.js" as="script">
<link rel="preload" href="/runtime~main.7131cbb2.js" as="script">
<link rel="preload" href="/main.b25045d7.js" as="script">
<link rel="preload" href="/1.896bc31d.js" as="script">
<link rel="preload" href="/2.fa85eb29.js" as="script">
<link rel="preload" href="/39.eaf06892.js" as="script">
<link rel="preload" href="/40.855290df.js" as="script">
<link rel="preload" href="/935f2afb.cbd92184.js" as="script">
<link rel="preload" href="/17896441.242cc5ad.js" as="script">
<link rel="preload" href="/db2cdce7.5e0265d0.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="SikuliX Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="SikuliX Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title"></strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://raiman.github.io/SikuliX1/downloads.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Downloads</a><a href="https://github.com/RaiMan" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">★ GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="SikuliX Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="SikuliX Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://raiman.github.io/SikuliX1/downloads.html" target="_blank" rel="noopener noreferrer" class="menu__link">Downloads</a></li><li class="menu__list-item"><a href="https://github.com/RaiMan" target="_blank" rel="noopener noreferrer" class="menu__link">★ GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Quick Start</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/installation">Installing SikuliX</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contribution">Contribution</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">SikuliX Scripts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scripts/about-scripts">About Scripts</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/scripts/running-scripts">Running Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scripts/js">Using JS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scripts/python">Using Python</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scripts/java">Using Java</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scripts/robotframework">Using RobotFramework</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Sikulix IDE</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ide/ide">Setup &amp; Use</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">SikuliX API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/scripting">Scripting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/interacting">Screen Interaction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/global">Global Settings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/region">Region</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/location">Location</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/screen">Screen</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/pattern">Pattern</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/match">Matching an Image</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/finder">Finder</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/keys">Keys</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/appclass">App Class</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/ocr">OCR &amp; Text</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/questions">Questions</a></li></ul></li><li class="menu__list-item"><a href="https://raiman.github.io/SikuliX1/downloads.html" target="_blank" rel="noreferrer noopener" class="menu__link">Downloads</a></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Running Scripts</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="where-and-how-can-a-sikulix-script-be-stored"></a>Where and how can a SikuliX script be stored<a class="hash-link" href="#where-and-how-can-a-sikulix-script-be-stored" title="Direct link to heading">#</a></h2><p>When you need to distribute your SikuliX scripts you have two options: <code>zip-file</code> and <code>jar-file</code>, both variants pack the SikuliX script content in one file, which makes distribution easier. Both can run with SikuliX.</p><p>The jar-file variant has an option to be packed together with the scripting and SikuliX feature support (self contained), so it might be run on systems only having a valid Java installation.</p><ul><li><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="variant-zip-file"></a>variant zip-file<a class="hash-link" href="#variant-zip-file" title="Direct link to heading">#</a></h4></li></ul><p>It can be created in the SikuliX IDE with the file menu entry “Export packed source” and gets the ending .skl instead of .sikuli. As such it cannot be reopened for editing nor used for import, it can only be run using SikuliX features on systems having a valid SikuliX setup. In fact it is simply a zip-file, which can be brought back to a .sikuli folder using a zip utility. So be aware, that this variant does not really hide your script content.</p><ul><li><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="variant-jar-file"></a>variant jar-file<a class="hash-link" href="#variant-jar-file" title="Direct link to heading">#</a></h4></li></ul><p>It can be created in the SikuliX IDE (file menu entry “Export as jar”). It can be run using SikuliX features on systems having a valid SikuliX setup. The script source is contained in compiled form (Java byte code) and hence not visible, even if one accesses the jar content. So this variant gives some level of secrecy for your scripted workflow.</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="how-to-run-a-sikulix-script"></a>How to run a SikuliX script<a class="hash-link" href="#how-to-run-a-sikulix-script" title="Direct link to heading">#</a></h2><p>You can run scripts by simply clicking run from the IDE or using the command line to run saved scripts (.sikuli) and exported scripts (.skl and .jar).  </p><p>You may also call/run scripts from a script that is currently running, which saves the startup time for the called script and keeps available the original parameters given and the current image path.</p><p><code>runScript(script_path, *parameter)</code></p><p>Runs the script found at the given script-path handing over the given parameters in sys.argv[1+]. The called script has it’s own bundle path, but the current image path. On exit the bundle path of the calling script is restored.</p><ul><li>Param:	`<code>script_path</code>: a path to a script folder (rules see below)</li><li>Param:	<code>parameter</code>: one or more parameters seperated by comma</li><li>Returns:	the return code that the called script has given with exit(n) (exception: n = 1 - see note)</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If the called script runs into an exception (e.g. FindFailed), that is not catched internally, the exception info is logged as [error] messages and the returned value is set to 1. To sort it out, the called script should use exit(0) (which is the default) on success and use exit(n) with n &gt; 1, to signal other cases to the calling script. <strong>Do not use values &lt; 0</strong>.</p></div></div><p>An example:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">exitValue = runScript(whatever)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if exitValue &gt; 1:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   print &quot;there was a special case&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">elif exitValue == 1:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   print &quot;there was an exception&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">else:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   print &quot;ran with success&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit(exitValue)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Make sure</strong>: each parameter MUST be a simple string.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="rules-for-the-given-script_path"></a>Rules for the given script_path<a class="hash-link" href="#rules-for-the-given-script_path" title="Direct link to heading">#</a></h4><ul><li>absolute path to a folder in the file system</li><li>relative path to a folder taken as relative to the working folder</li><li>the path spec can contain leading or intermediate ../</li><li>a path preceded by ./ means the same folder, that the calling script is located</li><li>a pointer to a folder in the HTTP net</li><li>in any case .sikuli can be omitted</li><li>if it is a .skl, then it must be noted as script.skl</li></ul><p><strong>Special usage notes for scripts located in the net</strong></p><ul><li>must be accessible via HTTP</li><li>where location is to the folder containing the script file (Python, Ruby or JavaScript) and the images (no .sikuli appended!)</li><li>The contained script file must have the same name as the script folder and a suffix<ul><li>for JavaScript <code>.js</code></li><li>for Python `<code>.py.txt</code></li><li>for Ruby <code>.rb.txt</code></li><li>the <code>.txt</code> suffixes are necessary, to avoid download problems</li></ul></li></ul><p>This feature allows to create a main script, that contains a row of <code>runScript()</code> commands, thus running these scripts one after the other in the same context (no startup delay). Using the return codes and the parameters allows to create medium complex workflows based on smaller reuseable entities.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="running-snippets"></a>Running snippets<a class="hash-link" href="#running-snippets" title="Direct link to heading">#</a></h4><p><code>runScript(snippet)</code></p><ul><li><strong>Param</strong>:	snippet: a string containing the scripting statements after the word identifying the script type</li><li><strong>Returns</strong>:	the return code that was returned by the interpreter running this snippet</li></ul><p>Currently available:</p><ul><li>AppleScript on Mac (script type word: applescript)</li><li>PowerShell on Windows (script type word: powershell)</li></ul><p><strong>Example for Applescript</strong>:</p><p><code>returnCode = runScript(&#x27;applescript tell application &quot;Mail&quot; to activate&#x27;)</code></p><p>or like this for a multiline snippet:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cmd = &quot;&quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">applescript</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tell application &quot;Mail&quot; to activate</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">display alert &quot;Mail should be visible now&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">returnCode = runScript(cmd)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Example for PowerShell</strong>:</p><p><code>returnCode = runScript(&#x27;powershell get-process&#x27;)</code></p><p>or like this for a multiline snippet:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cmd = &quot;&quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">powershell</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">get-process</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">returnCode = runScript(cmd)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>If the snippet produces some output on stdout and/or stderror, this is accessible after return using:</p><p><code>commandOutput = RunTime.get().getLastCommandResult()</code></p><hr></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/SikuliX/sikulix.github.io/edit/master/docs/docs/scripts/running-scripts.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/scripts/about-scripts"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« About Scripts</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/scripts/js"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Using JS »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#where-and-how-can-a-sikulix-script-be-stored" class="table-of-contents__link">Where and how can a SikuliX script be stored</a></li><li><a href="#how-to-run-a-sikulix-script" class="table-of-contents__link">How to run a SikuliX script</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/installation">Install</a></li><li class="footer__item"><a href="https://raiman.github.io/SikuliX1/downloads.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Downloads</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://answers.launchpad.net/sikuli" target="_blank" rel="noopener noreferrer" class="footer__link-item">Questions on LaunchPad</a></li><li class="footer__item"><a href="https://bugs.launchpad.net/sikuli" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues on LaunchPad</a></li><li class="footer__item"><a href="https://github.com/RaiMan/SikuliX1/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues on GitHub</a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/sikuli-x" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/RaiMan" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="http://sikulix.com/disclaimer/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Disclaimer</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 SikuliX. Built with Docusaurus by Panx Project.</div></div></div></footer></div>
<script src="/styles.6dc404e3.js"></script>
<script src="/runtime~main.7131cbb2.js"></script>
<script src="/main.b25045d7.js"></script>
<script src="/1.896bc31d.js"></script>
<script src="/2.fa85eb29.js"></script>
<script src="/39.eaf06892.js"></script>
<script src="/40.855290df.js"></script>
<script src="/935f2afb.cbd92184.js"></script>
<script src="/17896441.242cc5ad.js"></script>
<script src="/db2cdce7.5e0265d0.js"></script>
</body>
</html>