(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{116:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=i.a.createContext({}),c=function(e){var t=i.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},b=function(e){var t=c(e.components);return i.a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},u=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),b=c(n),u=a,m=b["".concat(l,".").concat(u)]||b[u]||d[u]||o;return n?i.a.createElement(m,r(r({ref:t},p),{},{components:n})):i.a.createElement(m,r({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=u;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:a,l[1]=r;for(var p=2;p<o;p++)l[p]=n[p];return i.a.createElement.apply(null,l)}return i.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},93:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return r})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return c}));var a=n(3),i=n(7),o=(n(0),n(116)),l={id:"interacting",title:"Screen Interaction",sidebar_label:"Screen Interaction"},r={unversionedId:"api/interacting",id:"api/interacting",isDocsHomePage:!1,title:"Screen Interaction",description:"User and App interaction",source:"@site/docs\\api\\interacting.md",slug:"/api/interacting",permalink:"/docs/api/interacting",editUrl:"https://github.com/SikuliX/sikulix.github.io/edit/website/docs/api/interacting.md",version:"current",sidebar_label:"Screen Interaction",sidebar:"docs",previous:{title:"Scripting",permalink:"/docs/api/scripting"},next:{title:"Global Settings",permalink:"/docs/api/global"}},s=[{value:"User and App interaction",id:"user-and-app-interaction",children:[{value:"PopUps and input dialogs",id:"popups-and-input-dialogs",children:[]}]},{value:"Timed (autoclosing) popups",id:"timed-autoclosing-popups",children:[]},{value:"Listening to Global Hotkeys",id:"listening-to-global-hotkeys",children:[]},{value:"Starting and stopping other applications",id:"starting-and-stopping-other-applications",children:[]}],p={toc:s};function c(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"user-and-app-interaction"},"User and App interaction"),Object(o.b)("p",null,"In the standard the following dialog boxes are shown in the middle of the screen, where SikuliX (IDE or from commandline) is running (usually the primary screen)."),Object(o.b)("h3",{id:"popups-and-input-dialogs"},"PopUps and input dialogs"),Object(o.b)("p",null,"If you want the dialog to appear in a special location on the screen (even on other screens in multimonitor situations), you can use the function ",Object(o.b)("inlineCode",{parentName:"p"},"popat()")," to define this location. The dialog will be positioned here with the center of its dialog panel. Be aware, that locations near the edge of the screen might make parts of the dialog not accessible (this is not checked). This location will stay in effect until changed by another use of ",Object(o.b)("inlineCode",{parentName:"p"},"popat()"),". A ",Object(o.b)("inlineCode",{parentName:"p"},"popat()")," without parameters will reset it to the standard (center of primary screen)."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"popat(x, y)"),"\n",Object(o.b)("strong",{parentName:"p"},"popat(location)"),"\n",Object(o.b)("strong",{parentName:"p"},"popat(region)"),"\n",Object(o.b)("strong",{parentName:"p"},"popat()"),"\nDefine the location, where the center of popup dialogs should be positioned from now on."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"x")," \u2013 x value of the location"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"y")," \u2013 y value of the location"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"location")," \u2013 the location as a Location"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"region")," \u2013 the location as the center of the given Region\nIf no parameter is given, the location will be reset to the center primary screen (default).")))),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"popup(text","[, title]",")"),"\nDisplay a dialog box with an ",Object(o.b)("inlineCode",{parentName:"p"},"OK")," button and text as the message. The script then waits for the user to click the ",Object(o.b)("inlineCode",{parentName:"p"},"OK")," button."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"text")," \u2013 text to be displayed as message"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"title")," \u2013 optional title for the messagebox (default: SikuliX Info)")))),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'popup("Hello World!\\nHave fun with SikuliX!")\nA dialog box that looks like below will popup\nNote: \\n inserts a line break\n_images/popup.png\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"popError(text","[, title]",")"),"\nSame as ",Object(o.b)("inlineCode",{parentName:"p"},"popup()")," but with a different title (default SikuliX Error) and alert icon."),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'popError("Uuups, this did not work")\nA dialog box that looks like below will popup\n\n_images/popError.png\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"popAsk(text","[, title]",")")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Returns:\t",Object(o.b)("inlineCode",{parentName:"li"},"True")," if user clicked Yes, False otherwise\nSame as ",Object(o.b)("inlineCode",{parentName:"li"},"popup()")," but with a different title (default SikuliX Decision) and alert icon.")),Object(o.b)("p",null,"There are 2 buttons: Yes and No and hence the message text should be written as an appropriate question."),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'answer = popAsk("Should we really continue?")\nif not answer:\n    exit(1)\nA dialog box that looks like below will popup\n\n_images/popAsk.png\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"input(","[msg][, default]","[, title][, hidden]",")"),"\nDisplay a dialog box with an input field, a ",Object(o.b)("inlineCode",{parentName:"p"},"Cancel")," button, and an ",Object(o.b)("inlineCode",{parentName:"p"},"OK")," button. The optional text title is displayed as the messagebox title and the text msg as some explanation near the input field. The script then waits for the user to click either the ",Object(o.b)("inlineCode",{parentName:"p"},"Cancel")," or the ",Object(o.b)("inlineCode",{parentName:"p"},"OK")," button."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"msg")," \u2013 text to be displayed as message (default: nothing)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"default")," \u2013 optional preset text for the input field"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"title")," \u2013 optional title for the messagebox (default: SikuliX Input)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"hidden")," \u2013 (default: False) if true the entered characters are shown as asterisks"))),Object(o.b)("li",{parentName:"ul"},"Returns:\nthe text, contained in the input field, when the user clicked ",Object(o.b)("inlineCode",{parentName:"li"},"Ok"))),Object(o.b)("p",null,"None, if the user pressed the ",Object(o.b)("inlineCode",{parentName:"p"},"Cancel")," button or closed the dialog"),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'name = input("Please enter your name to log in:")\n_images/input.png\nA dialog box that looks like above will appear to allow the user to interactively enter some text. This text is then assigned to the variable name, which can be used in other parts of the script, such as paste(name) to paste the text to a login box.\n')),Object(o.b)("p",null,"Example: input with preset:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'name = input("Please enter your name to log in:", "anonymous") # a preset input text\n_images/inputPreset.png\n')),Object(o.b)("p",null,"When using the parameter default, the text input field will be pre-populated with the given text, so the user might just click OK/Cancel or edit the content of the input field."),Object(o.b)("p",null,"Example: input with hidden input:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'password = input("please enter your secret", hidden = True)\n_images/inputHidden.png\n')),Object(o.b)("p",null,"As the user inputs his secret information, the text is shown as one asterisk per character."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"inputText(message",'[, title=""][, lines=9]','[, width=20][, text=""]',")")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"message")," \u2013 text to be displayed as message"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"title")," \u2013 optional title for the messagebox (default: SikuliX input request)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"lines")," \u2013 how many lines the text box should be high (default: 9)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"width")," \u2013 how many characters the box should have as width (default: 20)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"text")," \u2013 a multiline text, that is preset in the textarea"))),Object(o.b)("li",{parentName:"ul"},"Returns:\nthe multiline text content when user clicks ",Object(o.b)("inlineCode",{parentName:"li"},"OK")," (might be empty) or None if you click ",Object(o.b)("inlineCode",{parentName:"li"},"CANCEL"))),Object(o.b)("p",null,"A message box with the given height and width is displayed and allows the user to input as many lines of text as needed. The lines are auto-wrapped at word boundary. A vertical scrollbar is shown if needed."),Object(o.b)("p",null,"The default font is the Java AWT Dialog (a sans-serif font) in size 14, which is also the minimum size possible. One might switch to a monospace font using ",Object(o.b)("inlineCode",{parentName:"p"},"Settings.InputFontMono=True"),". Setting it to ",Object(o.b)("inlineCode",{parentName:"p"},"False")," switches it back to the standard for the next ",Object(o.b)("inlineCode",{parentName:"p"},"inputText()"),"."),Object(o.b)("p",null,"A bigger size than 14 can be set using ",Object(o.b)("inlineCode",{parentName:"p"},"Settings.InputFontSize=NN"),". Setting it to a value smaller than 14 (e.g. 0) will reset it to 14 again."),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'# selects a monospaced font\n# default is False meaning a SansSerif font\nSettings.InputFontMono = True\n\n# default fontsize is 14 (also minimum size)\n# use a fontsize of 20\nSettings.InputFontSize = 20\n\nstory = inputText("please tell a story")\nlines = story.split("\\n") # split the lines in the list lines\nfor line in lines:\n   print line\n_images/inputText.png\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"select(","[msg][, title]","[, options][, default]",")")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"msg")," \u2013 text to be displayed as message (default: nothing)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"title")," \u2013 optional title for the messagebox (default: Sikuli Selection)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"options")," \u2013 a list of text items (default: empty list, nothing done)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"default")," \u2013 the preselected list item (default: first item)"))),Object(o.b)("li",{parentName:"ul"},"Returns:\nthe selected item (might be the default)")),Object(o.b)("p",null,"Displays a dropdown menu containing the given options list items with the default selected. The user might select one item and click ok."),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'items = ("nothing selected", "item1", "item2", "item3")\nselected = select("Please select an item from the list", options = items)\nif selected == items[0]:\n   popup("You did not select an item")\n   exit(1)\n_images/select1.png _images/select2.png\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"popFile(","[title]",")"),"\nDisplay a file open dialog, that lets the user select a folder or file."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("strong",{parentName:"li"},"title")," \u2013 optional title for the dialogbox (default: Select a file or folder)"),Object(o.b)("li",{parentName:"ul"},"Returns:\tthe absolute path of the selected file or folder as a string")),Object(o.b)("hr",null),Object(o.b)("h2",{id:"timed-autoclosing-popups"},"Timed (autoclosing) popups"),Object(o.b)("p",null,"General information on using these features:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Jython Scripting: the usage in all cases is ",Object(o.b)("inlineCode",{parentName:"li"},"returnValue = Do.function()"),". Do not try any other usage, since this might clash with existing version 1 implementations."),Object(o.b)("li",{parentName:"ul"},"Since the implementation is only on the Java level, there are no named parameters (unlike the known non-timed versions of ",Object(o.b)("inlineCode",{parentName:"li"},"popup"),", ",Object(o.b)("inlineCode",{parentName:"li"},"popAsk"),", \u2026). Nevertheless it is possible to only give a subset of parameters, as long as the defined sequence is obeyed. In doubt use ",Object(o.b)("inlineCode",{parentName:"li"},"None/null")," for a parameter, to get the default value. See the given examples for use cases."),Object(o.b)("li",{parentName:"ul"},"If the dialog is autoclosed by intention, the return value is ",Object(o.b)("inlineCode",{parentName:"li"},"None/null")," in all cases.\n-The dialogs can only be displayed on the primary screen"),Object(o.b)("li",{parentName:"ul"},"Java usage in all cases is ",Object(o.b)("inlineCode",{parentName:"li"},"returnValue = SX.function()"),", since the feature is implemented in ",Object(o.b)("inlineCode",{parentName:"li"},"org.sikulix.script.SX"),".")),Object(o.b)("p",null,"These are the possible parameters and their defined sequence:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"message"),' a declarative text to be shown in the dialog (all methods, default "not set")'),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"title"),' the dialog box title (all methods, default "SikuliX")'),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"preset")," a prefilled input text (input, default empty)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"hidden")," a boolean value, True/true will show the input text as dots ((input, default False/false)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"timeout")," an integer as seconds after that the dialog will autoclose (all methods, default stay open)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"location")," a Region object, over which the dialog will be displayed centered (all methods, default screen center) which allows to place the dialog anywhere on the screen. As a convenience you can use ",Object(o.b)("inlineCode",{parentName:"li"},"Region(x, y)")," if you want to specify a point. Hence no need to use ",Object(o.b)("inlineCode",{parentName:"li"},"popAt()"),".")),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Do.popup(","[parameters]",")"),"\nDisplay an informational message with an ",Object(o.b)("inlineCode",{parentName:"p"},"OK")," button."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\tparameters \u2013 see above"),Object(o.b)("li",{parentName:"ul"},"Returns:\talways ",Object(o.b)("inlineCode",{parentName:"li"},"True"),", ",Object(o.b)("inlineCode",{parentName:"li"},"None/null")," if autoclosed")),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'result = ``Do.popup("autoclosed after 3 seconds", 3)``\nif not result:\n  print "user did not click ok"\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Do.popAsk(","[parameters]",")"),"\nDisplay an informational message with ",Object(o.b)("inlineCode",{parentName:"p"},"YES")," and ",Object(o.b)("inlineCode",{parentName:"p"},"NO")," button."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\tparameters \u2013 (see above)"),Object(o.b)("li",{parentName:"ul"},"Returns:\t",Object(o.b)("inlineCode",{parentName:"li"},"True")," if YES was clicked, ",Object(o.b)("inlineCode",{parentName:"li"},"False")," otherwise, ",Object(o.b)("inlineCode",{parentName:"li"},"None/null")," if autoclosed")),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'result = Do.popAsk("Nothing done if not\\nclicked within 3 seconds", "Your decision", 3)\nif None == result:\n  print "nothing to do"\nelif result:\n  print "user said yes"\nelse:\n  print "user said no"\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Do.popError(","[parameters]",")"),"\nDisplay an error message with an ",Object(o.b)("inlineCode",{parentName:"p"},"OK")," button."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\tparameters \u2013 see above"),Object(o.b)("li",{parentName:"ul"},"Returns:\talways ",Object(o.b)("inlineCode",{parentName:"li"},"True"),", None/null if autoclosed")),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'where = Region(0,0,300,300)\nresult = Do.popError("autoclosed after 3 seconds", "Severe Error", 3, where)\n# the dialog will display somewhere in the upper left of the screen\n# with a box title as "Severe Error"\nif not result:\n  print "user did not click ok"\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Do.input(","[parameters]",")"),"\nDisplay an informational message and ask for a text input with a possible preset text in the input field. The dialog has an ",Object(o.b)("inlineCode",{parentName:"p"},"OK")," and a ",Object(o.b)("inlineCode",{parentName:"p"},"Cancel")," button. With the hidden parameter as True/true the text in the input field will be shown as dots (not readable)."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\tparameters \u2013 see above"),Object(o.b)("li",{parentName:"ul"},"Returns:\tthe text in the input field, when clicked OK, False/false otherwise, None/null if autoclosed")),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'where = Region(0,0,300,300)\nresult = Do.input("please fill in", "A filename", "someImage.png", where)\n# the dialog will display somewhere in the upper left of the screen\n# with a box title as "A filename"\n# and a preset input field containing "someImage.png"\nif not result:\n  # input field was left empty\n  print "we will use a default file name"\nelse:\n  print "we will use as filename: " + result\n')),Object(o.b)("p",null,"Example for hidden input:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'password = Do.input("please enter your secret", "Secret", "defaultSecret", True, 10)\n# the dialog\'s input field displays the text as dots per character\nif not password:\n  # password is empty or dialog autoclosed\n  print "not allowed - exiting"\n  exit(1)\n# we can proceed\n')),Object(o.b)("hr",null),Object(o.b)("h2",{id:"listening-to-global-hotkeys"},"Listening to Global Hotkeys"),Object(o.b)("p",null,"SikuliX can listen to global hotkeys that you register with ",Object(o.b)("inlineCode",{parentName:"p"},"Env.addHotkey")," and call the corresponding handler (sikulix functions) when the user presses the hotkeys."),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"Be sure, that the key combination you use is free and not used by the system or any other application. The hotkey feature may not report an error in such situations and as a consequence your hotkey definition simply does not work as expected. An example is the F12 key on Windows alone or with SHIFT, which in the standard is occupied by the system as global debugging key (might be released by hacking the registry)."))),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Env.addHotkey(key, modifiers, handler)"),"\nRegister the specified key + modifiers as a global hotkey. When the hotkey is pressed, the specified function handler will be called."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"key")," \u2013 a character or a constant value defined in ",Object(o.b)("a",{parentName:"li",href:"#"},"Key"),"."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"modifiers")," \u2013 Key modifiers, which can be one or multiple constants defined in KeyModifier."))),Object(o.b)("li",{parentName:"ul"},"Returns:\n",Object(o.b)("inlineCode",{parentName:"li"},"True")," if success.")),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},"def openAppleMenu(event):\n   click()\n\n# When the user pressed Ctrl+Alt+F1, click the top-left apple icon.\nEnv.addHotkey(Key.F1, KeyModifier.ALT+KeyModifier.CTRL, openAppleMenu)\n")),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Env.removeHotkey(key, modifiers)"),"\nUnregister the registered global hotkey key + modifiers."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"key")," \u2013 a character or a constant value defined in Key."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"modifiers")," \u2013 Key modifiers, which can be one or multiple constants defined in KeyModifier."))),Object(o.b)("li",{parentName:"ul"},"Returns:\n",Object(o.b)("inlineCode",{parentName:"li"},"True")," if success.")),Object(o.b)("p",null,"A more generic example"),Object(o.b)("p",null,"It keeps the handlers free from processing code, just signals the keypress using a global variable to the main loop. The main loop simply permanently scans the global variables and then does what has to be done."),Object(o.b)("p",null,"The whole process is blocking in the sense, that hotkeys are processed one after the other in the sequence they appear in the main loop and each hotkey is only recognized again, after its current press is processed in the main loop."),Object(o.b)("p",null,"This setup keeps things more transparent and straightforward. Other setups even with threading are possible, but need much more effort to correctly synchronize the processing especially when mouse or keyboard actions are involved."),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'# hotkey to stop the script\nhotKeyX = False; # global to communicate with main loop\ndef xHandler(event):\n  global hotKeyX\n  hotKeyX = True # tell main loop that hotkey was pressed\n# add the hotkey with its handler\nEnv.addHotkey("x", KeyModifier.CTRL + KeyModifier.SHIFT, xHandler)\n\n# function hotkey: something to do when pressed\nhotKeyN = False;\ndef nHandler(event):\n  global hotKeyN\n  hotKeyN = True\nEnv.addHotkey("n", KeyModifier.CTRL + KeyModifier.SHIFT, nHandler)\n\n# the main loop, that simply waits for pressed hotkeys\n# which are then processed\ncount = 0;\nwhile True:\n  if (hotKeyX):\n    popup("processing ctrl+shift+x: stopping")\n    exit()\n  if (hotKeyN):\n    hotKeyN = False # reset the hotkey variable\n    # and now do something\n    count += 1\n    popup("processing ctrl+shift+n: %d" % count)\n  wait(1)\n')),Object(o.b)("p",null,"Another example showing some specials"),Object(o.b)("p",null,"All hotkeys use ",Object(o.b)("inlineCode",{parentName:"p"},"ctrl-alt")," as modifieres:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'### hotkey setup section ###\n\n# variants to end the script\nEnv.addHotkey("x", KeyModifier.ALT+KeyModifier.CTRL, lambda e: exit())\nEnv.addHotkey("q", KeyModifier.ALT+KeyModifier.CTRL, quit)\n\ndef quit(event):\n  print "handler quit ctrl-alt-x"\n  global running\n  running = False\n\n# basic hotkey definition with a related handler name\nEnv.addHotkey("c", KeyModifier.ALT+KeyModifier.CTRL, handlerC)\n\ndef handlerC(event):\n  print "handlerC: seconds since start:", int((time.time() - start))\n\n# at hotkey press a function will be called whose name is currently held by variable todo\nEnv.addHotkey("v", KeyModifier.ALT+KeyModifier.CTRL, lambda e: todo(e))\n\ndef handlerC1(event):\n  print "handlerC1: seconds since start:", int((time.time() - start))\n\ntodo = handlerC # default at start of script\n\n# at hotkey press the function handlerParam will be called\n# with a parameter value currently held by global variable start\nEnv.addHotkey("b", KeyModifier.ALT+KeyModifier.CTRL, lambda e: handlerParam(start))\n\ndef handlerParam(begin):\n  print "handlerParam: seconds since start:", int((time.time() - begin))\n\n### main workflow start ###\nstart = time.time() # a global variable used in the handlers\ncount = 0\n\nrunning = True\nwhile running: # will end the loop if running is False\n\n  wait(1) # some timeconsuming stuff here\n\n  # one can always check in between and leave the loop\n  if not running: break\n\n  wait(1) # some timeconsuming stuff here\n\n# changes the handler for hotkey v after about 20 seconds\n  count += 1\n  if count > 10: todo = handlerC1\n\n# here might be some postprocessing before script finally ends\n# you might remove your hotkeys before, to avoid interference by the handlers\nprint "PostProcessing"\n')),Object(o.b)("p",null,"The variants to end the script show a graceful version (",Object(o.b)("inlineCode",{parentName:"p"},"ctrl-alt-q"),") and a brute-force version (",Object(o.b)("inlineCode",{parentName:"p"},"ctrl-alt-x"),")."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"The graceful version just signals the keypress via a global variable and leaves it to the main workflow to react, when it makes sense."),Object(o.b)("li",{parentName:"ul"},"The brute-force variant uses a lambda expression (anonymous function with only a single expression), that stops the script without notice at time of key press")),Object(o.b)("hr",null),Object(o.b)("h2",{id:"starting-and-stopping-other-applications"},"Starting and stopping other applications"),Object(o.b)("p",null,"Here we talk about the basic features of opening or closing other applications and switching to them (bring them to front)."),Object(o.b)("p",null,"You can use the feature ",Object(o.b)("inlineCode",{parentName:"p"},"run(someCommand)")," to delegate something, you can do on a commandline, to a seperate process. The script waits for completion and you have acces to the return code and the output the command has produced."),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"On Java usage At the Java level only the features of the App class are available (class App)."))),Object(o.b)("p",null,"General hint for Windows users on backslashes ",Object(o.b)("inlineCode",{parentName:"p"},"\\")," and double apostrophes ",Object(o.b)("inlineCode",{parentName:"p"},"\u201c")),Object(o.b)("p",null,"In a SikuliX script in normal strings enclosed in ",Object(o.b)("inlineCode",{parentName:"p"},"\u201d")," (double apostrophes), these special characters \\ and \u201d have to be escaped using a backslash, when you have them inside the string. So for one backslash you need \\ and for one \u201d you need \". In a string enclosed in \u2018 (single apostrophes), a \u2018 has to be ' and a \u201d is taken as such."),Object(o.b)("p",null,"To avoid any problems, it is recommended to use the raw string r'some text with \\ and \" ...', since there is no need for escaping (but no trailing \\ is allowed here)."),Object(o.b)("p",null,"This is especially useful, when you have to specify Windows path\u2019s containing blanks or want to setup command lines for use with ",Object(o.b)("inlineCode",{parentName:"p"},"openApp()"),", ",Object(o.b)("inlineCode",{parentName:"p"},"App.open()"),", ",Object(o.b)("inlineCode",{parentName:"p"},"run()"),", ",Object(o.b)("inlineCode",{parentName:"p"},"os.popen()")," or Jythons Subprocess module."),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"for Mac users As application name use the name, that is displayed with the program symbol on the taskbar, which might differ from what is displayed in the top left of the menu bar."))),Object(o.b)("p",null,"Example: The Chrome browser displays \u201cChrome\u201d in the menu bar, but the application name is \u201cGoogle Chrome\u201d. So ",Object(o.b)("inlineCode",{parentName:"p"},"openApp(\u201cchrome\u201d)")," will fail, whereas ",Object(o.b)("inlineCode",{parentName:"p"},"openApp(\u201cgoogle chrome\u201d)")," will do the job. Same goes for ",Object(o.b)("inlineCode",{parentName:"p"},"switchApp()")," and ",Object(o.b)("inlineCode",{parentName:"p"},"closeApp()"),"."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"openApp(application)"),"\nOpen the specified application, or swith to it, if it is already open."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\tapplication \u2013 a string containing the name of an application (case-insensitive), that can be found in the path used by the system to locate applications. Or it can be the full path to an application."),Object(o.b)("li",{parentName:"ul"},"Returns: None if an error occured, on success a new ",Object(o.b)("inlineCode",{parentName:"li"},"App")," class object")),Object(o.b)("p",null,"This function opens the specified application and brings it to front. It might switch to an already opened application, if this can be identified in the process list."),Object(o.b)("p",null,"Windows: A running instance will be ignored in any case and hence in most cases a new instance of the program will be started."),Object(o.b)("p",null,"Examples:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'# Windows: run a batch file in a new command window:\n`\xf2penApp("cmd.exe /c start path-to-some.bat")``\n\n# Windows: opens Firefox (full path specified)\n``openApp("c:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe")`` or\n``openApp(r"c:\\Program Files\\Mozilla Firefox\\firefox.exe")``\n\n# Mac: opens Safari\n``openApp("Safari")``\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"switchApp(application)"),"\nBring the matching application or window to front (make it the active/focused application/window). If no matching application/window can be found, it is tried to open an application using the given string as program name or location."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("strong",{parentName:"li"},"application")," \u2013 the name of an application (case-insensitive) or (part of) a window title (Windows/Linux) (case-sensitive)."),Object(o.b)("li",{parentName:"ul"},"Returns: ",Object(o.b)("inlineCode",{parentName:"li"},"None")," if an error occured, on success a new ",Object(o.b)("inlineCode",{parentName:"li"},"App")," class object")),Object(o.b)("p",null,"This function switches the input focus to the specified application (brings it to front)."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Windows"),": In the first step, the given text is taken as part of a program name (not case sensitive). If it is found in the process list, it will be switched to front, if it has a main window (registered in the process list). Otherwise the text will be used to search for a matching window title."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Windows/Linux"),": the window is identified by scanning the titles of all accessible windows for the occurence of the application string. The first window in the system specific order, whose title contains the given text, is given focus."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Mac"),": the string application is used to identify the application. If the application has multiple windows opened, all these windows will be brought to the front with unchanged z-order, which cannot be influenced currently."),Object(o.b)("p",null,"Examples:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'# Windows: switches to an already opened Firfox or opens it otherwise\nswitchApp("c:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe")\n\n# Windows: switches to the frontmost opened browser window (or does nothing\n# if no Firefox window is currently opened)\n# works, because all Firefox window titles contain "Mozilla Firefox"\nswitchApp("Mozilla Firefox")\n\n# Mac: switches to Safari or starts it\nswitchApp("Safari")\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"closeApp(application)"),"\nClose the specified application."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("strong",{parentName:"li"},"application")," \u2013 the name of an application (case-insensitive) or (part of) a window title (Windows/Linux)"),Object(o.b)("li",{parentName:"ul"},"Returns: ",Object(o.b)("inlineCode",{parentName:"li"},"None")," if an error occured, on success a new ",Object(o.b)("inlineCode",{parentName:"li"},"App")," class object")),Object(o.b)("p",null,"This function closes the application indicated by the string application (Mac) or the windows whose titles contain the string application (Windows/Linux). On Windows/Linux, the application itself may be closed if the main window is closed or if all the windows of the application are closed."),Object(o.b)("p",null,"Example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'# Windows: closes Firefox if it is running, does nothing otherwise\ncloseApp("c:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe")\n\n# Windows: stops firefox including all its windows\ncloseApp("Mozilla Firefox")\n\n# Mac: closes Safari including all its windows\ncloseApp("Safari")\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"run(command)"),"\nRun command in the command line"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Parameters:\t",Object(o.b)("strong",{parentName:"li"},"command")," \u2013 a command that can be run from the command line."),Object(o.b)("li",{parentName:"ul"},"Returns:\ta multiline string containing the result of the execution")),Object(o.b)("p",null,"This function executes the command and the script waits for its completion."),Object(o.b)("p",null,"structure of the result (comments after #, not part of the result)"),Object(o.b)("p",null,"Multiline string:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},"N # a number being the return code\ntext\ntext\ntext\ntext # no, one or more lines execution output (stdout)\n*****error***** # if the execution ended with an error\nerror text # or the return code was not 0\nerror text\nerror text # no, one or more lines error output (stderr)\n")),Object(o.b)("hr",null))}c.isMDXComponent=!0}}]);