(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{116:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return u}));var a=n(0),i=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=i.a.createContext({}),p=function(e){var t=i.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},b=function(e){var t=p(e.components);return i.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},h=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,r=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),b=p(n),h=a,u=b["".concat(r,".").concat(h)]||b[h]||d[h]||o;return n?i.a.createElement(u,s(s({ref:t},l),{},{components:n})):i.a.createElement(u,s({ref:t},l))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var l=2;l<o;l++)r[l]=n[l];return i.a.createElement.apply(null,r)}return i.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},95:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return p}));var a=n(3),i=n(7),o=(n(0),n(116)),r={id:"other",title:"Other Languages",sidebar_label:"Other Languages"},s={unversionedId:"scripts/other",id:"scripts/other",isDocsHomePage:!1,title:"Other Languages",description:"About other programming or scripting languages",source:"@site/docs\\scripts\\other.md",slug:"/scripts/other",permalink:"/docs/scripts/other",editUrl:"https://github.com/SikuliX/sikulix.github.io/edit/website/docs/scripts/other.md",version:"current",sidebar_label:"Other Languages",sidebar:"docs",previous:{title:"Using Java",permalink:"/docs/scripts/java"},next:{title:"Work in progress",permalink:"/docs/ide/work-in-progress-ide"}},c=[{value:"About other programming or scripting languages",id:"about-other-programming-or-scripting-languages",children:[]},{value:"JavaScript",id:"javascript",children:[]},{value:"RobotFramework",id:"robotframework",children:[]}],l={toc:c};function p(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"about-other-programming-or-scripting-languages"},"About other programming or scripting languages"),Object(o.b)("h2",{id:"javascript"},"JavaScript"),Object(o.b)("p",null,"The support for JavaScript is based on the Java integrated engine Nashorn (available since Java 7)."),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"Since Java 11 Nashorn is marked deprecated and might be removed in a future Java version. With Java 13 (available September 2019) it is still there and hence will be there till September 2020."))),Object(o.b)("p",null,"A candidate to be used with SikuliX and JavaScript scripting in the future will be the GraalVM package. People who try already now with SikuliX 2.0.4+ are welcome to give feedback about their experiences on GitHub."),Object(o.b)("p",null,"The easiest approach for JavaScript scripting:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"switch a new editor tab in the IDE to type JavaScript (rigt-click on an empty Tab, select Set Type in the context men\xfc and then select javascript from the drop down list)."),Object(o.b)("li",{parentName:"ul"},"The bottom status line at the right side now will show (javascript)"),Object(o.b)("li",{parentName:"ul"},"now you can write JavaScript code according to the specifications of the Java bundled JavaScript interpreter (Nashorn since Java 1.7)."),Object(o.b)("li",{parentName:"ul"},"before running the script the first time, you have to save it")),Object(o.b)("p",null,"Example: "),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},'Debug.user("hello from JavaScript");\nvar img = "img.png";\nhover(img); // uses Screen(0) like in Python\nvar scr = new Screen();\nprint(scr);\nscr.hover(img); // uses the Region scr\n')),Object(o.b)("p",null,"The SikuliX features in general have to be used like in Java programming."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"All classes from ",Object(o.b)("inlineCode",{parentName:"li"},"org.sikuli.script")," are known (pre-imported)."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"Debug")," and ",Object(o.b)("inlineCode",{parentName:"li"},"Settings")," are also known.")),Object(o.b)("p",null,"the following undotted methods work on Screen(0):"),Object(o.b)("code",null,"wait, waitVanish, exists, click, doubleClick, rightClick, hover"),Object(o.b)("p",null,"and you have undotted:"),Object(o.b)("code",null,"type, write, paste, run"),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},Object(o.b)("inlineCode",{parentName:"p"},"FindFailed")," is not thrown! internally returns null!\nIf you want to catch exceptions, you have to use the dotted methods."))),Object(o.b)("h2",{id:"robotframework"},"RobotFramework"),Object(o.b)("p",null,"Running Robot scripts work out of the box in the Sikulix context (IDE or from commandline). The needed Python module robot ( from ",Object(o.b)("inlineCode",{parentName:"p"},"robotframework 3.0")," ) is bundled with the ",Object(o.b)("inlineCode",{parentName:"p"},"sikulixapi.jar"),". At runtime and already with setup, the module is exported to the folder ",Object(o.b)("inlineCode",{parentName:"p"},"<SikulixAppData>/Lib"),", which is on ",Object(o.b)("inlineCode",{parentName:"p"},"sys.path")," automatically. So there is no need to have anything else available than a suitable setup of SikuliX."),Object(o.b)("p",null,"The easiest way is to use the SikuliX IDE with this principal setup"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'\nrunScript("""\nrobot\n*** Variables ***\n${USERNAME}               demo\n${PASSWORD}               mode\n${TESTSITE}               http://test.sikuli.de\n*** Settings ***\nLibrary           ./inline/LoginLibrary\nTest Setup        start firefox and goto testsite    ${TESTSITE}\nTest Teardown     stop firefox\n*** Test Cases ***\nUser can log in with correct user and password\n    Attempt to Login with Credentials    ${USERNAME}    ${PASSWORD}\n    Status Should Be    Accepted\nUser cannot log in with invalid user or bad password\n    Attempt to Login with Credentials    betty    wrong\n    Status Should Be    Denied\n""")\n\nclass LoginLibrary(object):\n  def start_firefox_and_goto_testsite(self, page):\n    popup("start_firefox_and_goto_testsite")\n  def stop_firefox(self):\n    popup("stop_firefox")\n  def attempt_to_login_with_credentials(self, username, password):\n    popup("attempt_to_login_with_credentials")\n  def status_should_be(self, expected):\n    popup("status_should_be")\n\n')),Object(o.b)("p",null,"the first 2 lines, signal, that you want to run an inline Robot script, that follows on the next lines terminated by ",Object(o.b)("inlineCode",{parentName:"p"},'"""'),"). This construct is a multiline Python comment, that can be used as a string."),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"A report HTML will be automatically opened in the standard browser at termination. If you do not wnat that (e.g. in unattended situations) use this instaed as the first 2 lines. Take care: after robot 1 space, a linefeed directly after silent and nothing else."))),Object(o.b)("p",null,"Example"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'runScript("""\nrobot silent\n')),Object(o.b)("p",null,"Normally when working with SikuliX features, you have to do some Robot Keyword implementation at the Python level. To Robot you tell where to find these implementation using the ",Object(o.b)("inlineCode",{parentName:"p"},"Library")," setting."),Object(o.b)("p",null,"In this case we have the implementations inline in the same scriptfile according to the Robot rules packed into a Python class having the Keyword methods according to the Robot naming conventions. At runtime this class will be exported to a Python file, whose absolute path is then replacing the ",Object(o.b)("inlineCode",{parentName:"p"},"Library")," setting."),Object(o.b)("p",null,"If you have the Keyword implementations somewhere outside, then you have to put the correct path specification into the ",Object(o.b)("inlineCode",{parentName:"p"},"Library")," setting. Another option is to reference a jar file as a ",Object(o.b)("inlineCode",{parentName:"p"},"Library")," again according to the Robot specifications."),Object(o.b)("p",null,"If you now run the script in the IDE, internally a ",Object(o.b)("inlineCode",{parentName:"p"},"robot.run")," will be fired after having setup the script content and the environment. Currently no extra options can be provided for the robot run. As a result you get a folder with the ending ",Object(o.b)("inlineCode",{parentName:"p"},".robot")," named as your script in the same folder as your script folder containing inputs to and the results from the robot run"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},"# supposing the script is named testrobot.sikuli\n# then you get a folder testrobot.sikuli.robot with the content\ntestrobot.robot # the robot script\nLoginLibrary.py # the Python Keyword implementations\n# the standard Robot outcome\noutput.xml\nlog.html\nreport.html\n")),Object(o.b)("p",null,"Another possible setup in the IDE would be this way:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'robotScript = """\nrobot\n*** Variables ***\n${USERNAME}               demo\n${PASSWORD}               mode\n${TESTSITE}               http://test.sikuli.de\n*** Settings ***\nLibrary           /some/path/to/LoginLibrary.py\nTest Setup        start firefox and goto testsite    ${TESTSITE}\nTest Teardown     stop firefox\n*** Test Cases ***\nUser can log in with correct user and password\n    Attempt to Login with Credentials    ${USERNAME}    ${PASSWORD}\n    Status Should Be    Accepted\nUser cannot log in with invalid user or bad password\n    Attempt to Login with Credentials    betty    wrong\n    Status Should Be    Denied\n"""\n\n# here you could do some preprocessing and even modify the above robotscript\n\nrunScript(robotscript)\n\n# eventually do something with the result\n')),Object(o.b)("div",{className:"admonition admonition-important alert alert--info"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"important")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"The ",Object(o.b)("inlineCode",{parentName:"p"},"Name")," in the file name ",Object(o.b)("inlineCode",{parentName:"p"},"Name.py")," and the statement ",Object(o.b)("inlineCode",{parentName:"p"},"class Name()")," must be the same and start with an uppercase letter."))),Object(o.b)("div",{className:"admonition admonition-important alert alert--info"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"important")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"The file path must be escaped with 4 backslashes for each backslash like so ",Object(o.b)("inlineCode",{parentName:"p"},"C:\\\\\\\\Robot\\\\\\\\Libraries\\\\\\\\Name.py")," (which leads to the needed 2 backslashes for each backslash as escape in the final robot file)"))),Object(o.b)("p",null,"Of course you can use any other method, to fill a string representing a valid Robot script, provided the first line contains the string ",Object(o.b)("inlineCode",{parentName:"p"},"robot")," and only that (denoting the script type for runScript)."),Object(o.b)("p",null,"If in such a case you want to provide an inline Keyword implementation: this does the trick:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'# prepare your script content\nrunScript("robot\\n" + scriptContent)\n# eventually do something with the result\n\n# """)\n\n# the rest is taken as inline Keyword implementation\n')),Object(o.b)("p",null,"If you have the need to specify extra parameters to the ",Object(o.b)("inlineCode",{parentName:"p"},"robot.run()"),", then you still have the option to stay within the SikuliX context (IDE or from commandline):"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},'prepareRobot() # takes care for the correct environment\n\nworkdir = getParentFolder()\nscript = "arobottest/arobottest.robot"\nrobotscript = os.path.join(workdir, script)\n\nprint "*** trying to run:", robotscript\nrobot.run(robotscript, outputdir=workdir)\n')),Object(o.b)("p",null,"A library .py file being either in the script folder itself or in the folder containing the script folder is found automatically. So simply the library name is enough in this case. In all other cases you either have to specify the absolute path off the .py script (take care with windows - see above) or use ",Object(o.b)("inlineCode",{parentName:"p"},"addImportPath()")," to add the folder containing the library .py file to sys.path, in which case again only the name is sufficient in the Robot script."),Object(o.b)("p",null,"It is strongly recommended, to always specify the ",Object(o.b)("inlineCode",{parentName:"p"},"outputdir= parameter")," since otherwise the reportfiles will be written to the working folder (from where you are running), which might not always be what you want."),Object(o.b)("p",null,"If you want to use any of these variants outside the SikuliX context (some external Jython or in an IDE like PyCharm) you have to add these 2 lines at the beginning of your main script (as always in such cases):"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-code"},"import org.sikuli.script.SikulixForJython\nfrom sikuli import *\n")),Object(o.b)("p",null,"to get the SikuliX context ready."))}p.isMDXComponent=!0}}]);